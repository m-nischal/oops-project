{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 34, "column": 0}, "map": {"version":3,"sources":["file:///Users/nischalreddymuthumula/Desktop/untitled%20folder/src/components/Header.js"],"sourcesContent":["// src/components/Header.js\nimport Link from \"next/link\";\nimport { useEffect, useState } from \"react\";\n\nexport default function Header() {\n  const [count, setCount] = useState(0);\n  useEffect(() => {\n    try {\n      const cart = JSON.parse(localStorage.getItem(\"lm_cart\") || \"[]\");\n      setCount(cart.reduce((s, i) => s + (i.qty||0), 0));\n    } catch (e) { setCount(0); }\n    const onStorage = () => {\n      try {\n        const cart = JSON.parse(localStorage.getItem(\"lm_cart\") || \"[]\");\n        setCount(cart.reduce((s, i) => s + (i.qty||0), 0));\n      } catch (e) {}\n    };\n    window.addEventListener(\"storage\", onStorage);\n    return () => window.removeEventListener(\"storage\", onStorage);\n  }, []);\n\n  return (\n    <header style={{ display:\"flex\", justifyContent:\"space-between\", padding:\"1rem\", borderBottom:\"1px solid #eee\" }}>\n      <div>\n        <Link href=\"/\" style={{ fontWeight:700, fontSize:18 }}>LiveMart (dev)</Link>\n      </div>\n      <nav>\n        <Link href=\"/cart\">Cart ({count})</Link>\n      </nav>\n    </header>\n  );\n}\n"],"names":[],"mappings":"AAAA,2BAA2B;;;;;;AAC3B;AACA;;;;AAEe,SAAS;IACtB,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,+GAAQ,EAAC;IACnC,IAAA,gHAAS,EAAC;QACR,IAAI;YACF,MAAM,OAAO,KAAK,KAAK,CAAC,aAAa,OAAO,CAAC,cAAc;YAC3D,SAAS,KAAK,MAAM,CAAC,CAAC,GAAG,IAAM,IAAI,CAAC,EAAE,GAAG,IAAE,CAAC,GAAG;QACjD,EAAE,OAAO,GAAG;YAAE,SAAS;QAAI;QAC3B,MAAM,YAAY;YAChB,IAAI;gBACF,MAAM,OAAO,KAAK,KAAK,CAAC,aAAa,OAAO,CAAC,cAAc;gBAC3D,SAAS,KAAK,MAAM,CAAC,CAAC,GAAG,IAAM,IAAI,CAAC,EAAE,GAAG,IAAE,CAAC,GAAG;YACjD,EAAE,OAAO,GAAG,CAAC;QACf;QACA,OAAO,gBAAgB,CAAC,WAAW;QACnC,OAAO,IAAM,OAAO,mBAAmB,CAAC,WAAW;IACrD,GAAG,EAAE;IAEL,qBACE,qKAAC;QAAO,OAAO;YAAE,SAAQ;YAAQ,gBAAe;YAAiB,SAAQ;YAAQ,cAAa;QAAiB;;0BAC7G,qKAAC;0BACC,cAAA,qKAAC,gIAAI;oBAAC,MAAK;oBAAI,OAAO;wBAAE,YAAW;wBAAK,UAAS;oBAAG;8BAAG;;;;;;;;;;;0BAEzD,qKAAC;0BACC,cAAA,qKAAC,gIAAI;oBAAC,MAAK;;wBAAQ;wBAAO;wBAAM;;;;;;;;;;;;;;;;;;AAIxC","debugId":null}},
    {"offset": {"line": 118, "column": 0}, "map": {"version":3,"sources":["file:///Users/nischalreddymuthumula/Desktop/untitled%20folder/src/pages/product/%5Bid%5D.js"],"sourcesContent":["// src/pages/product/[id].js\nimport { useRouter } from \"next/router\";\nimport { useEffect, useState } from \"react\";\nimport Header from \"components/Header\";\n\nexport default function ProductDetail() {\n  const router = useRouter();\n  const { id } = router.query;\n  const [prod, setProd] = useState(null);\n  const [sizes, setSizes] = useState([]);\n  const [size, setSize] = useState(\"\");\n  const [qty, setQty] = useState(1);\n  const [sizeStock, setSizeStock] = useState(null);\n\n  useEffect(() => {\n    if (!id) return;\n    (async () => {\n      try {\n        const res = await fetch(`/api/products/${id}`);\n        if (!res.ok) throw new Error(\"Failed to load product\");\n        const data = await res.json();\n        setProd(data);\n\n        // fetch inventory sizes for this product\n        const inv = await fetch(`/api/inventory/${id}`);\n        if (inv.ok) {\n          const invData = await inv.json();\n          setSizes(invData.sizes || []);\n          if (invData.sizes && invData.sizes.length) {\n            setSize(invData.sizes[0].label);\n            setSizeStock(invData.sizes[0].stock || 0);\n          }\n        }\n      } catch (e) {\n        console.error(e);\n      }\n    })();\n  }, [id]);\n\n  // when selected size changes, update sizeStock\n  useEffect(() => {\n    if (!size) { setSizeStock(null); return; }\n    const s = sizes.find(s => s.label === size);\n    setSizeStock(s ? (s.stock || 0) : null);\n    // clamp qty to available stock\n    if (s && qty > (s.stock || 0)) setQty(s.stock || 1);\n  }, [size, sizes]);\n\n  function onQtyChange(n) {\n    const v = Math.max(1, Number(n));\n    if (sizeStock !== null && v > sizeStock) {\n      setQty(sizeStock);\n      alert(`Only ${sizeStock} available for size ${size}`);\n      return;\n    }\n    setQty(v);\n  }\n\n  function addToCart() {\n    if (!size) return alert(\"Pick a size\");\n    // re-check in-memory stock\n    if (sizeStock !== null && qty > sizeStock) {\n      return alert(`Cannot add ${qty}. Only ${sizeStock} available for size ${size}`);\n    }\n\n    const cart = JSON.parse(localStorage.getItem(\"lm_cart\") || \"[]\");\n    const existing = cart.find(c => c.productId === prod._id && c.sizeLabel === size);\n    if (existing) {\n      const newQty = existing.qty + Number(qty || 1);\n      if (sizeStock !== null && newQty > sizeStock) {\n        return alert(`Cannot add ${qty}. Total would be ${newQty}, but only ${sizeStock} available.`);\n      }\n      existing.qty = newQty;\n    } else {\n      cart.push({ productId: prod._id, name: prod.name, unitPrice: prod.price, sizeLabel: size, qty: Number(qty) });\n    }\n    localStorage.setItem(\"lm_cart\", JSON.stringify(cart));\n    window.dispatchEvent(new Event(\"storage\"));\n    alert(\"Added to cart\");\n  }\n\n  if (!prod) return <>\n    <Header />\n    <div style={{ padding:20 }}>Loading…</div>\n  </>;\n\n  return (\n    <div>\n      <Header />\n      <main style={{ padding:20 }}>\n        <div style={{ display:\"flex\", gap:20 }}>\n          <div style={{ width:360 }}>\n            <img src={(prod.images && prod.images[0]) || \"/images/placeholder.png\"} alt={prod.name} style={{ width:\"100%\", borderRadius:6 }} />\n          </div>\n          <div style={{ flex:1 }}>\n            <h1>{prod.name}</h1>\n            <p>{prod.description}</p>\n            <div style={{ fontWeight:700 }}>₹{prod.price}</div>\n\n            <div style={{ marginTop:12 }}>\n              <label>Size</label>\n              <select value={size} onChange={(e)=>setSize(e.target.value)} style={{ marginLeft:8 }}>\n                {sizes.length ? sizes.map(s => <option key={s.label} value={s.label}>{s.label} ({s.stock})</option>)\n                  : <option value=\"\">Default</option>}\n              </select>\n            </div>\n\n            <div style={{ marginTop:12 }}>\n              <label>Qty</label>\n              <input type=\"number\" value={qty} min={1} onChange={(e)=>onQtyChange(e.target.value)} style={{ width:80, marginLeft:8 }} />\n              {sizeStock !== null ? <span style={{ marginLeft:12 }}>Available: {sizeStock}</span> : null}\n            </div>\n\n            <div style={{ marginTop:16 }}>\n              <button onClick={addToCart}>Add to cart</button>\n            </div>\n          </div>\n        </div>\n      </main>\n    </div>\n  );\n}\n"],"names":[],"mappings":"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","debugId":null}}]
}