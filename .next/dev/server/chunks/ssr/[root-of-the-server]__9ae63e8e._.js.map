{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/rajag/OneDrive/Desktop/vamsi/oops%20project/livemart-19112025/Project%20OOPS/src/utils/redirectByRole.js"],"sourcesContent":["// utils/redirectByRole.js (helper)\nexport async function redirectIfLoggedIn(ctxOrClientSide) {\n  // client-side example:\n  const token = localStorage.getItem(\"token\");\n  if (!token) return;\n  // optionally decode token to get role\n  try {\n    const payload = JSON.parse(atob(token.split(\".\")[1]));\n    const role = payload.role;\n    if (role === \"RETAILER\") location.replace(\"/retailer/dashboard\");\n    else if (role === \"WHOLESALER\") location.replace(\"/wholesaler/dashboard\");\n    else location.replace(\"/customer/home\");\n  } catch (err) {\n    // fallback: call /api/auth/me to get fresh data\n  }\n}\n"],"names":[],"mappings":"AAAA,mCAAmC;;;;;AAC5B,eAAe,mBAAmB,eAAe;IACtD,uBAAuB;IACvB,MAAM,QAAQ,aAAa,OAAO,CAAC;IACnC,IAAI,CAAC,OAAO;IACZ,sCAAsC;IACtC,IAAI;QACF,MAAM,UAAU,KAAK,KAAK,CAAC,KAAK,MAAM,KAAK,CAAC,IAAI,CAAC,EAAE;QACnD,MAAM,OAAO,QAAQ,IAAI;QACzB,IAAI,SAAS,YAAY,SAAS,OAAO,CAAC;aACrC,IAAI,SAAS,cAAc,SAAS,OAAO,CAAC;aAC5C,SAAS,OAAO,CAAC;IACxB,EAAE,OAAO,KAAK;IACZ,gDAAgD;IAClD;AACF","debugId":null}},
    {"offset": {"line": 28, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/rajag/OneDrive/Desktop/vamsi/oops%20project/livemart-19112025/Project%20OOPS/src/pages/login.js"],"sourcesContent":["// src/pages/login.js\nimport { useState, useEffect } from \"react\";\nimport { redirectIfLoggedIn } from \"../utils/redirectByRole\";\n\nexport default function LoginPage() {\n  const [email, setEmail] = useState(\"\");\n  const [password, setPassword] = useState(\"\");\n  const [message, setMessage] = useState(\"\");\n\n  // Redirect if already logged in (run only on client)\n  useEffect(() => {\n    if (typeof window !== \"undefined\") {\n      redirectIfLoggedIn();\n    }\n  }, []);\n\n  function isProbablyEmail(value) {\n    return typeof value === \"string\" && value.includes(\"@\") && value.indexOf(\"@\") > 0;\n  }\n\n  async function handleLogin(e) {\n    e.preventDefault();\n    setMessage(\"\");\n\n    const trimmedEmail = email.trim().toLowerCase();\n    if (!isProbablyEmail(trimmedEmail)) {\n      setMessage(\"Please enter a valid email address.\");\n      return;\n    }\n\n    if (!password) {\n      setMessage(\"Please enter your password.\");\n      return;\n    }\n\n    const body = {\n      email: trimmedEmail,\n      password,\n    };\n\n    try {\n      const res = await fetch(\"/api/auth/login\", {\n        method: \"POST\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify(body),\n      });\n\n      const data = await res.json();\n\n      if (!data.ok) {\n        setMessage(data.message || \"Login failed\");\n        return;\n      }\n\n      // Save token\n      localStorage.setItem(\"token\", data.token);\n\n      // Redirect by role\n      try {\n        const payload = JSON.parse(atob(data.token.split(\".\")[1]));\n        if (payload.role === \"RETAILER\") window.location.href = \"/retailer/dashboard\";\n        else if (payload.role === \"WHOLESALER\") window.location.href = \"/wholesaler/dashboard\";\n        else window.location.href = \"/customer/home\";\n      } catch (err) {\n        // fallback redirect\n        window.location.href = \"/\";\n      }\n    } catch (err) {\n      console.error(\"Login error:\", err);\n      setMessage(\"Network error. Please try again.\");\n    }\n  }\n\n  return (\n    <div style={{ padding: \"20px\" }}>\n      <h2>Login</h2>\n\n      <form onSubmit={handleLogin}>\n        <input\n          type=\"email\"\n          placeholder=\"Email\"\n          value={email}\n          onChange={(e) => setEmail(e.target.value)}\n          required\n          style={{ display: \"block\", marginBottom: \"10px\", width: \"250px\" }}\n        />\n\n        <input\n          type=\"password\"\n          placeholder=\"Password\"\n          value={password}\n          onChange={(e) => setPassword(e.target.value)}\n          required\n          style={{ display: \"block\", marginBottom: \"10px\", width: \"250px\" }}\n        />\n\n        <button type=\"submit\">Login</button>\n\n        {/* Always-visible forgot-password link (placed under the button) */}\n        <div style={{ marginTop: \"10px\" }}>\n          <a href=\"/forgot-password\" style={{ color: \"blue\" }}>\n            Forgot Password? Reset using email OTP\n          </a>\n        </div>\n      </form>\n\n      {message && <div style={{ color: \"red\", marginTop: \"10px\" }}>{message}</div>}\n\n      <hr />\n\n      <h3>Or login with Google</h3>\n      <a href=\"/api/auth/signin\">Sign in with Google</a>\n    </div>\n  );\n}\n"],"names":[],"mappings":"AAAA,qBAAqB;;;;;;AACrB;AACA;;;;AAEe,SAAS;IACtB,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,+GAAQ,EAAC;IACnC,MAAM,CAAC,UAAU,YAAY,GAAG,IAAA,+GAAQ,EAAC;IACzC,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,+GAAQ,EAAC;IAEvC,qDAAqD;IACrD,IAAA,gHAAS,EAAC;QACR;;IAGF,GAAG,EAAE;IAEL,SAAS,gBAAgB,KAAK;QAC5B,OAAO,OAAO,UAAU,YAAY,MAAM,QAAQ,CAAC,QAAQ,MAAM,OAAO,CAAC,OAAO;IAClF;IAEA,eAAe,YAAY,CAAC;QAC1B,EAAE,cAAc;QAChB,WAAW;QAEX,MAAM,eAAe,MAAM,IAAI,GAAG,WAAW;QAC7C,IAAI,CAAC,gBAAgB,eAAe;YAClC,WAAW;YACX;QACF;QAEA,IAAI,CAAC,UAAU;YACb,WAAW;YACX;QACF;QAEA,MAAM,OAAO;YACX,OAAO;YACP;QACF;QAEA,IAAI;YACF,MAAM,MAAM,MAAM,MAAM,mBAAmB;gBACzC,QAAQ;gBACR,SAAS;oBAAE,gBAAgB;gBAAmB;gBAC9C,MAAM,KAAK,SAAS,CAAC;YACvB;YAEA,MAAM,OAAO,MAAM,IAAI,IAAI;YAE3B,IAAI,CAAC,KAAK,EAAE,EAAE;gBACZ,WAAW,KAAK,OAAO,IAAI;gBAC3B;YACF;YAEA,aAAa;YACb,aAAa,OAAO,CAAC,SAAS,KAAK,KAAK;YAExC,mBAAmB;YACnB,IAAI;gBACF,MAAM,UAAU,KAAK,KAAK,CAAC,KAAK,KAAK,KAAK,CAAC,KAAK,CAAC,IAAI,CAAC,EAAE;gBACxD,IAAI,QAAQ,IAAI,KAAK,YAAY,OAAO,QAAQ,CAAC,IAAI,GAAG;qBACnD,IAAI,QAAQ,IAAI,KAAK,cAAc,OAAO,QAAQ,CAAC,IAAI,GAAG;qBAC1D,OAAO,QAAQ,CAAC,IAAI,GAAG;YAC9B,EAAE,OAAO,KAAK;gBACZ,oBAAoB;gBACpB,OAAO,QAAQ,CAAC,IAAI,GAAG;YACzB;QACF,EAAE,OAAO,KAAK;YACZ,QAAQ,KAAK,CAAC,gBAAgB;YAC9B,WAAW;QACb;IACF;IAEA,qBACE,qKAAC;QAAI,OAAO;YAAE,SAAS;QAAO;;0BAC5B,qKAAC;0BAAG;;;;;;0BAEJ,qKAAC;gBAAK,UAAU;;kCACd,qKAAC;wBACC,MAAK;wBACL,aAAY;wBACZ,OAAO;wBACP,UAAU,CAAC,IAAM,SAAS,EAAE,MAAM,CAAC,KAAK;wBACxC,QAAQ;wBACR,OAAO;4BAAE,SAAS;4BAAS,cAAc;4BAAQ,OAAO;wBAAQ;;;;;;kCAGlE,qKAAC;wBACC,MAAK;wBACL,aAAY;wBACZ,OAAO;wBACP,UAAU,CAAC,IAAM,YAAY,EAAE,MAAM,CAAC,KAAK;wBAC3C,QAAQ;wBACR,OAAO;4BAAE,SAAS;4BAAS,cAAc;4BAAQ,OAAO;wBAAQ;;;;;;kCAGlE,qKAAC;wBAAO,MAAK;kCAAS;;;;;;kCAGtB,qKAAC;wBAAI,OAAO;4BAAE,WAAW;wBAAO;kCAC9B,cAAA,qKAAC;4BAAE,MAAK;4BAAmB,OAAO;gCAAE,OAAO;4BAAO;sCAAG;;;;;;;;;;;;;;;;;YAMxD,yBAAW,qKAAC;gBAAI,OAAO;oBAAE,OAAO;oBAAO,WAAW;gBAAO;0BAAI;;;;;;0BAE9D,qKAAC;;;;;0BAED,qKAAC;0BAAG;;;;;;0BACJ,qKAAC;gBAAE,MAAK;0BAAmB;;;;;;;;;;;;AAGjC","debugId":null}}]
}