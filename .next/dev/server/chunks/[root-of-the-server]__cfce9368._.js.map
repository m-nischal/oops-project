{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 28, "column": 0}, "map": {"version":3,"sources":["file:///Users/nischalreddymuthumula/Desktop/untitled%20folder%20copy/src/models/productModel.js"],"sourcesContent":["// models/productModel.js\nimport mongoose from \"mongoose\";\n\n/**\n * Product model\n * - sizes: array with {label, stock}\n * - categories: ObjectId refs to Category\n */\n\nconst SizeSchema = new mongoose.Schema({\n  label: { type: String, required: true },\n  stock: { type: Number, default: 0, min: 0 }\n}, { _id: false });\n\nconst ProductSchema = new mongoose.Schema({\n  name: { type: String, required: true, trim: true, text: true },\n  description: { type: String, trim: true, default: \"\" , text: true},\n  sku: { type: String, trim: true, index: true, sparse: true },\n  price: { type: Number, required: true },\n  originalPrice: { type: Number },\n  currency: { type: String, default: \"INR\" },\n  images: { type: [String], default: [] },\n  sizes: { type: [SizeSchema], default: [] }, // inventory per size\n  // normalized categories\n  categories: [{ type: mongoose.Schema.Types.ObjectId, ref: \"Category\" }],\n  primaryCategory: { type: mongoose.Schema.Types.ObjectId, ref: \"Category\", default: null },\n  storefronts: { type: [String], default: [\"livemart\"] },\n  productType: { type: String, enum: [\"clothing\", \"tech\", \"grocery\", \"other\"], default: \"other\" },\n  // optional top-level stock (if you want)\n  stock: { type: Number, default: undefined },\n  isActive: { type: Boolean, default: true },\n  createdBy: { type: mongoose.Schema.Types.ObjectId, ref: \"User\", required: false }\n}, { timestamps: true });\n\nProductSchema.index({ name: \"text\", description: \"text\" });\nProductSchema.index({ categories: 1 });\nProductSchema.index({ primaryCategory: 1 });\nProductSchema.index({ storefronts: 1 });\nProductSchema.index({ productType: 1 });\n\nProductSchema.pre(\"save\", function (next) {\n  if (!this.storefronts || !Array.isArray(this.storefronts)) this.storefronts = [\"livemart\"];\n  this.storefronts = this.storefronts.map(s => String(s).trim().toLowerCase()).filter(Boolean);\n  if (!this.categories) this.categories = [];\n  this.categories = this.categories.filter(c => !(typeof c === \"string\" && c.trim() === \"\"));\n  if (this.name) this.name = String(this.name).trim();\n  if (this.description) this.description = String(this.description).trim();\n  next();\n});\n\nProductSchema.methods.totalStock = function () {\n  if (Array.isArray(this.sizes) && this.sizes.length) return this.sizes.reduce((s, x) => s + (Number(x.stock) || 0), 0);\n  if (typeof this.stock === \"number\") return this.stock;\n  return 0;\n};\n\nexport default mongoose.models.Product || mongoose.model(\"Product\", ProductSchema);\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 178, "column": 0}, "map": {"version":3,"sources":["file:///Users/nischalreddymuthumula/Desktop/untitled%20folder%20copy/src/pages/api/products/%5Bid%5D.js"],"sourcesContent":["// src/pages/api/products/[id].js\nimport mongoose from \"mongoose\";\nimport dotenv from \"dotenv\";\nimport Product from \"../../../models/productModel.js\";\ndotenv.config();\n\nexport default async function handler(req, res) {\n  if (!mongoose.connection.readyState) await mongoose.connect(process.env.MONGO_URI);\n  const { id } = req.query;\n\n  if (req.method === \"GET\") {\n    try {\n      const prod = await Product.findById(id).lean();\n      if (!prod) return res.status(404).json({ message: \"Not found\" });\n      return res.status(200).json(prod);\n    } catch (err) {\n      console.error(err);\n      return res.status(400).json({ message: \"Invalid product ID\" });\n    }\n  }\n\n  res.status(405).json({ message: \"Method not allowed\" });\n}\n"],"names":[],"mappings":"AAAA,iCAAiC;;;;;AACjC;AACA;AACA;;;;AACA,gHAAM,CAAC,MAAM;AAEE,eAAe,QAAQ,GAAG,EAAE,GAAG;IAC5C,IAAI,CAAC,oHAAQ,CAAC,UAAU,CAAC,UAAU,EAAE,MAAM,oHAAQ,CAAC,OAAO,CAAC,QAAQ,GAAG,CAAC,SAAS;IACjF,MAAM,EAAE,EAAE,EAAE,GAAG,IAAI,KAAK;IAExB,IAAI,IAAI,MAAM,KAAK,OAAO;QACxB,IAAI;YACF,MAAM,OAAO,MAAM,iIAAO,CAAC,QAAQ,CAAC,IAAI,IAAI;YAC5C,IAAI,CAAC,MAAM,OAAO,IAAI,MAAM,CAAC,KAAK,IAAI,CAAC;gBAAE,SAAS;YAAY;YAC9D,OAAO,IAAI,MAAM,CAAC,KAAK,IAAI,CAAC;QAC9B,EAAE,OAAO,KAAK;YACZ,QAAQ,KAAK,CAAC;YACd,OAAO,IAAI,MAAM,CAAC,KAAK,IAAI,CAAC;gBAAE,SAAS;YAAqB;QAC9D;IACF;IAEA,IAAI,MAAM,CAAC,KAAK,IAAI,CAAC;QAAE,SAAS;IAAqB;AACvD","debugId":null}}]
}